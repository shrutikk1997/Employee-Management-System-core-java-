package db;
import java.sql.*;
import java.util.ArrayList;

import javax.swing.JOptionPane;

import com.mysql.jdbc.Connection;
import com.mysql.jdbc.Statement;

import module.User;
import view.LoginFrame;
import java.sql.*;
public class DAOuser
{
	static Class c1;
	static String url;
	static Connection con;
	static Statement s1;
   
  
  
    static
    {
    	try
    	{
    	c1=Class.forName("com.mysql.jdbc.Driver");
   	 url="jdbc:mysql://localhost:3306/user";
			con=(Connection) DriverManager.getConnection(url,"root","9922980310");
			System.out.println("connection successful");
			s1=(Statement) con.createStatement();
			
			
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
   
    }

	public boolean insert(User u1) {
		// TODO Auto-generated method stub
	try {
		String name=u1.getUsername();
		String pass=u1.getPassword();
		String city=u1.getCity();
		PreparedStatement st=con.prepareStatement("insert into user values(?,?,?)");
	    st.setString(1, name);
	    st.setString(2,pass );
	    st.setString(3, city);
	    st.addBatch();
	    st.execute();
	    
	//s1.execute("insert into user values(name,pass,city);");
	System.out.println("row added");
		//for(int i=0;i<arruser.size();i++)
			//System.out.println();
		return true;
	}catch (ArrayIndexOutOfBoundsException e) {
		// TODO: handle exception
	System.out.println("Regisration Full");
		return false;
	} catch (Exception e) {
		// TODO: handle exception
		e.printStackTrace();
		return false;
	}

	}


	public boolean validateuser(User u1)
	{
		// TODO Auto-generated method stub
	
		int flag=0;
		String user=u1.getUsername();
		String pass=u1.getPassword();
		ResultSet rs=null;
		try {
			rs = s1.executeQuery("select * from user");
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		try {
			while(rs.next())
			{
				String u=rs.getString(1);
				String p=rs.getString(2);
				System.out.println(u);
				System.out.println(p);
				if(u==user&& p==pass)
				{
					//flag =1;
					System.out.println("login successful");
					return true;
				}
				else
				{
					//flag=0;
					System.out.println("login fail");
					return false;
				}
					
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		/*if(flag==1)
		{
			return true;
		}
		else
		{
			return false;
		}*/
	}
}
	/*
	public boolean checklength() {
		// TODO Auto-generated method stub
		if(arruser.size()==0)
		{
			return true;
		}
		else
		{
			return false;
		}
	}

	
}
*/